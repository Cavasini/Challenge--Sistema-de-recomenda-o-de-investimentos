name: CI - Develop

on:
    push:
        branches: ["develop"]
    pull_request:
        branches: ["develop"]

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout
              uses: actions/checkout@v3

            # --- InvestmentDataService ---
            - name: Build InvestmentDataService JAR
              working-directory: ./InvestmentDataService # Garante que o comando seja executado no diretório do serviço
              run: mvn clean install -DskipTests # Compila o projeto e gera o JAR. -DskipTests para pular testes e ser mais rápido

            - name: Build InvestmentDataService Docker Image
              working-directory: ./InvestmentDataService
              run: docker build -t investmentdataservice:latest .

            # --- ProfileAnalyzerService ---
            - name: Build ProfileAnalyzerService JAR
              working-directory: ./ProfileAnalyzerService
              run: mvn clean install -DskipTests

            - name: Build ProfileAnalyzerService Docker Image
              working-directory: ./ProfileAnalyzerService
              run: docker build -t profileanalyzerservice:latest .

            # --- RecommenderService ---
            - name: Build RecommenderService JAR
              working-directory: ./RecommenderService
              run: mvn clean install -DskipTests

            - name: Build RecommenderService Docker Image
              working-directory: ./RecommenderService
              run: docker build -t recommender-service:latest .

            # --- AuthService ---
            - name: Build AuthService JAR
              working-directory: ./AuthService
              run: mvn clean install -DskipTests

            - name: Build AuthService Docker Image
              working-directory: ./AuthService
              run: docker build -t auth-service:latest .
